# syntax=docker/dockerfile:1
FROM openjdk:17-jdk-slim
RUN mkdir /app
EXPOSE 3002

ARG JAR_FILE

ARG EVENTS_URL_DATABASE
ARG DATABASE_USERNAME
ARG DATABASE_PASSWORD
ARG SPRING_MAIL_USERNAME
ARG SPRING_MAIL_PASSWORD
ARG JWT_SECRET
ARG AZURE_STORAGE_CONNECTION_STRING

ENV EVENTS_URL_DATABASE=$EVENTS_URL_DATABASE
ENV DATABASE_USERNAME=$DATABASE_USERNAME
ENV DATABASE_PASSWORD=$DATABASE_PASSWORD
ENV SPRING_MAIL_USERNAME=$SPRING_MAIL_USERNAME
ENV SPRING_MAIL_PASSWORD=$SPRING_MAIL_PASSWORD
ENV JWT_SECRET=$JWT_SECRET
ENV AZURE_STORAGE_CONNECTION_STRING=$AZURE_STORAGE_CONNECTION_STRING

COPY /target/${JAR_FILE} /app/app.jar
WORKDIR /app
ENTRYPOINT ["java", "-jar", "app.jar"]